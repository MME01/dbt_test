{{ config(
    cluster_by = ["_airbyte_unique_key","_airbyte_emitted_at"],
    partition_by = {"field": "_airbyte_emitted_at", "data_type": "timestamp", "granularity": "day"},
    unique_key = "_airbyte_unique_key",
    schema = "lnd_ula_pnet_prd",
    tags = [ "top-level" ],
    post_hook='{{ 
        apply_default_policy_tag(this, "projects/df-central-command-prd/locations/us/taxonomies/3753529189283377636/policyTags/1570780607584273335")
    }}'
) }}
-- Final base SQL model
-- depends_on: {{ ref('LND_TBL_STD_PERSON_scd') }}
select
    _airbyte_unique_key,
    STD_SSN,
    SCO_PHOTO,
    ID_APPROLE,
    ID_SECUSER,
    SCO_SMOKER,
    SGE_ID_VSW,
    STD_SS_KEY,
    SBR_ID_RACA,
    SCB_DIG_VER,
    SCO_GB_NAME,
    STD_COMMENT,
    SUS_VETERAN,
    CCL_CK_BENEF,
    SAR_EXPEDIDO,
    SGE_ID_TITEL,
    STD_AFILIADO,
    STD_DT_BIRTH,
    CCL_LACTANCIA,
    CCL_OCUPACION,
    SCO_HOME_PAGE,
    SCO_ID_REGION,
    SSP_ID_TP_DOC,
    STD_ID_GENDER,
    STD_ID_PERSON,
    STD_SS_NUMBER,
    CCL_ID_COUNTRY,
    CCL_ID_GEO_DIV,
    DT_LAST_UPDATE,
    SCO_PHOTO_INET,
    STD_ID_COUNTRY,
    STD_ID_GEO_DIV,
    SUS_DEATH_DATE,
    CCB_DRIVERS_NUM,
    ID_ORGANIZATION,
    SGE_ID_ADD_NAME,
    SUK_MAIDEN_NAME,
    CCL_CONOCIDO_POR,
    DESCRIPCION_LOTE,
    FECHA_APLIC_LOTE,
    SGE_N_NAME_COMPL,
    STD_ID_GEO_PLACE,
    STD_N_FAM_NAME_1,
    STD_N_FIRST_NAME,
    STD_N_USUAL_NAME,
    STD_PERMISO_TRAB,
    STD_TALLA_CAMISA,
    SUS_ID_ETHNICITY,
    CCL_NOCONTRATABLE,
    SFR_N_MAIDEN_NAME,
    SSP_PRIM_APELLIDO,
    STD_ID_SALUTATION,
    STD_N_MAIDEN_NAME,
    SUS_ID_VET_DIS_TY,
    CCB_BIRTH_CERT_NUM,
    CCL_DATE_ADITIONAL,
    CCL_ID_SUB_GEO_DIV,
    CCL_ID_SUCURSAL_SS,
    CCL_NAME_ADITIONA2,
    CCL_NAME_ADITIONA3,
    CCL_NAME_ADITIONA4,
    CCL_NAME_ADITIONAL,
    IDENTIFICADOR_LOTE,
    M4CCL_ALTURA_PERSO,
    M4CCL_ID_TIPO_ALTU,
    M4CCL_ID_TIPO_PESO,
    M4CCL_PESO_PERSONA,
    SAR_N_MARRIED_NAME,
    SFR_NM_BIRTH_PLACE,
    SSP_ID_PAIS_EMISOR,
    STD_ID_SUB_GEO_DIV,
    STD_TALLA_PANTALON,
    SUK_OTHER_FORENAME,
    SUK_PREVIOUS_SURNA,
    SUS_ID_VETERAN_WHE,
    STD_AHORRO_EXT_ASOC,
    STD_AHO_ESC_EXT_ASOC,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    {{ current_timestamp() }} as _airbyte_normalized_at,
    _airbyte_LND_TBL_STD_PERSON_hashid
from {{ ref('LND_TBL_STD_PERSON_scd') }}
-- LND_TBL_STD_PERSON from {{ source('lnd_ula_pnet_prd', '_airbyte_raw_LND_TBL_STD_PERSON') }}
where 1 = 1
and _airbyte_active_row = 1
{{ incremental_clause('_airbyte_emitted_at', this) }}

