{{ config(
    cluster_by = "_airbyte_emitted_at",
    partition_by = {"field": "_airbyte_emitted_at", "data_type": "timestamp", "granularity": "day"},
    unique_key = '_airbyte_ab_id',
    schema = "_airbyte_lnd_ula_pnet_prd",
    tags = [ "top-level-intermediate" ]
) }}
-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: {{ source('lnd_ula_pnet_prd', '_airbyte_raw_LND_TBL_STD_PERSON') }}
select
    {{ json_extract_scalar('_airbyte_data', ['STD_SSN'], ['STD_SSN']) }} as STD_SSN,
    {{ json_extract_scalar('_airbyte_data', ['SCO_PHOTO'], ['SCO_PHOTO']) }} as SCO_PHOTO,
    {{ json_extract_scalar('_airbyte_data', ['ID_APPROLE'], ['ID_APPROLE']) }} as ID_APPROLE,
    {{ json_extract_scalar('_airbyte_data', ['ID_SECUSER'], ['ID_SECUSER']) }} as ID_SECUSER,
    {{ json_extract_scalar('_airbyte_data', ['SCO_SMOKER'], ['SCO_SMOKER']) }} as SCO_SMOKER,
    {{ json_extract_scalar('_airbyte_data', ['SGE_ID_VSW'], ['SGE_ID_VSW']) }} as SGE_ID_VSW,
    {{ json_extract_scalar('_airbyte_data', ['STD_SS_KEY'], ['STD_SS_KEY']) }} as STD_SS_KEY,
    {{ json_extract_scalar('_airbyte_data', ['SBR_ID_RACA'], ['SBR_ID_RACA']) }} as SBR_ID_RACA,
    {{ json_extract_scalar('_airbyte_data', ['SCB_DIG_VER'], ['SCB_DIG_VER']) }} as SCB_DIG_VER,
    {{ json_extract_scalar('_airbyte_data', ['SCO_GB_NAME'], ['SCO_GB_NAME']) }} as SCO_GB_NAME,
    {{ json_extract_scalar('_airbyte_data', ['STD_COMMENT'], ['STD_COMMENT']) }} as STD_COMMENT,
    {{ json_extract_scalar('_airbyte_data', ['SUS_VETERAN'], ['SUS_VETERAN']) }} as SUS_VETERAN,
    {{ json_extract_scalar('_airbyte_data', ['CCL_CK_BENEF'], ['CCL_CK_BENEF']) }} as CCL_CK_BENEF,
    {{ json_extract_scalar('_airbyte_data', ['SAR_EXPEDIDO'], ['SAR_EXPEDIDO']) }} as SAR_EXPEDIDO,
    {{ json_extract_scalar('_airbyte_data', ['SGE_ID_TITEL'], ['SGE_ID_TITEL']) }} as SGE_ID_TITEL,
    {{ json_extract_scalar('_airbyte_data', ['STD_AFILIADO'], ['STD_AFILIADO']) }} as STD_AFILIADO,
    {{ json_extract_scalar('_airbyte_data', ['STD_DT_BIRTH'], ['STD_DT_BIRTH']) }} as STD_DT_BIRTH,
    {{ json_extract_scalar('_airbyte_data', ['CCL_LACTANCIA'], ['CCL_LACTANCIA']) }} as CCL_LACTANCIA,
    {{ json_extract_scalar('_airbyte_data', ['CCL_OCUPACION'], ['CCL_OCUPACION']) }} as CCL_OCUPACION,
    {{ json_extract_scalar('_airbyte_data', ['SCO_HOME_PAGE'], ['SCO_HOME_PAGE']) }} as SCO_HOME_PAGE,
    {{ json_extract_scalar('_airbyte_data', ['SCO_ID_REGION'], ['SCO_ID_REGION']) }} as SCO_ID_REGION,
    {{ json_extract_scalar('_airbyte_data', ['SSP_ID_TP_DOC'], ['SSP_ID_TP_DOC']) }} as SSP_ID_TP_DOC,
    {{ json_extract_scalar('_airbyte_data', ['STD_ID_GENDER'], ['STD_ID_GENDER']) }} as STD_ID_GENDER,
    {{ json_extract_scalar('_airbyte_data', ['STD_ID_PERSON'], ['STD_ID_PERSON']) }} as STD_ID_PERSON,
    {{ json_extract_scalar('_airbyte_data', ['STD_SS_NUMBER'], ['STD_SS_NUMBER']) }} as STD_SS_NUMBER,
    {{ json_extract_scalar('_airbyte_data', ['CCL_ID_COUNTRY'], ['CCL_ID_COUNTRY']) }} as CCL_ID_COUNTRY,
    {{ json_extract_scalar('_airbyte_data', ['CCL_ID_GEO_DIV'], ['CCL_ID_GEO_DIV']) }} as CCL_ID_GEO_DIV,
    {{ json_extract_scalar('_airbyte_data', ['DT_LAST_UPDATE'], ['DT_LAST_UPDATE']) }} as DT_LAST_UPDATE,
    {{ json_extract_scalar('_airbyte_data', ['SCO_PHOTO_INET'], ['SCO_PHOTO_INET']) }} as SCO_PHOTO_INET,
    {{ json_extract_scalar('_airbyte_data', ['STD_ID_COUNTRY'], ['STD_ID_COUNTRY']) }} as STD_ID_COUNTRY,
    {{ json_extract_scalar('_airbyte_data', ['STD_ID_GEO_DIV'], ['STD_ID_GEO_DIV']) }} as STD_ID_GEO_DIV,
    {{ json_extract_scalar('_airbyte_data', ['SUS_DEATH_DATE'], ['SUS_DEATH_DATE']) }} as SUS_DEATH_DATE,
    {{ json_extract_scalar('_airbyte_data', ['CCB_DRIVERS_NUM'], ['CCB_DRIVERS_NUM']) }} as CCB_DRIVERS_NUM,
    {{ json_extract_scalar('_airbyte_data', ['ID_ORGANIZATION'], ['ID_ORGANIZATION']) }} as ID_ORGANIZATION,
    {{ json_extract_scalar('_airbyte_data', ['SGE_ID_ADD_NAME'], ['SGE_ID_ADD_NAME']) }} as SGE_ID_ADD_NAME,
    {{ json_extract_scalar('_airbyte_data', ['SUK_MAIDEN_NAME'], ['SUK_MAIDEN_NAME']) }} as SUK_MAIDEN_NAME,
    {{ json_extract_scalar('_airbyte_data', ['CCL_CONOCIDO_POR'], ['CCL_CONOCIDO_POR']) }} as CCL_CONOCIDO_POR,
    {{ json_extract_scalar('_airbyte_data', ['DESCRIPCION_LOTE'], ['DESCRIPCION_LOTE']) }} as DESCRIPCION_LOTE,
    {{ json_extract_scalar('_airbyte_data', ['FECHA_APLIC_LOTE'], ['FECHA_APLIC_LOTE']) }} as FECHA_APLIC_LOTE,
    {{ json_extract_scalar('_airbyte_data', ['SGE_N_NAME_COMPL'], ['SGE_N_NAME_COMPL']) }} as SGE_N_NAME_COMPL,
    {{ json_extract_scalar('_airbyte_data', ['STD_ID_GEO_PLACE'], ['STD_ID_GEO_PLACE']) }} as STD_ID_GEO_PLACE,
    {{ json_extract_scalar('_airbyte_data', ['STD_N_FAM_NAME_1'], ['STD_N_FAM_NAME_1']) }} as STD_N_FAM_NAME_1,
    {{ json_extract_scalar('_airbyte_data', ['STD_N_FIRST_NAME'], ['STD_N_FIRST_NAME']) }} as STD_N_FIRST_NAME,
    {{ json_extract_scalar('_airbyte_data', ['STD_N_USUAL_NAME'], ['STD_N_USUAL_NAME']) }} as STD_N_USUAL_NAME,
    {{ json_extract_scalar('_airbyte_data', ['STD_PERMISO_TRAB'], ['STD_PERMISO_TRAB']) }} as STD_PERMISO_TRAB,
    {{ json_extract_scalar('_airbyte_data', ['STD_TALLA_CAMISA'], ['STD_TALLA_CAMISA']) }} as STD_TALLA_CAMISA,
    {{ json_extract_scalar('_airbyte_data', ['SUS_ID_ETHNICITY'], ['SUS_ID_ETHNICITY']) }} as SUS_ID_ETHNICITY,
    {{ json_extract_scalar('_airbyte_data', ['CCL_NOCONTRATABLE'], ['CCL_NOCONTRATABLE']) }} as CCL_NOCONTRATABLE,
    {{ json_extract_scalar('_airbyte_data', ['SFR_N_MAIDEN_NAME'], ['SFR_N_MAIDEN_NAME']) }} as SFR_N_MAIDEN_NAME,
    {{ json_extract_scalar('_airbyte_data', ['SSP_PRIM_APELLIDO'], ['SSP_PRIM_APELLIDO']) }} as SSP_PRIM_APELLIDO,
    {{ json_extract_scalar('_airbyte_data', ['STD_ID_SALUTATION'], ['STD_ID_SALUTATION']) }} as STD_ID_SALUTATION,
    {{ json_extract_scalar('_airbyte_data', ['STD_N_MAIDEN_NAME'], ['STD_N_MAIDEN_NAME']) }} as STD_N_MAIDEN_NAME,
    {{ json_extract_scalar('_airbyte_data', ['SUS_ID_VET_DIS_TY'], ['SUS_ID_VET_DIS_TY']) }} as SUS_ID_VET_DIS_TY,
    {{ json_extract_scalar('_airbyte_data', ['CCB_BIRTH_CERT_NUM'], ['CCB_BIRTH_CERT_NUM']) }} as CCB_BIRTH_CERT_NUM,
    {{ json_extract_scalar('_airbyte_data', ['CCL_DATE_ADITIONAL'], ['CCL_DATE_ADITIONAL']) }} as CCL_DATE_ADITIONAL,
    {{ json_extract_scalar('_airbyte_data', ['CCL_ID_SUB_GEO_DIV'], ['CCL_ID_SUB_GEO_DIV']) }} as CCL_ID_SUB_GEO_DIV,
    {{ json_extract_scalar('_airbyte_data', ['CCL_ID_SUCURSAL_SS'], ['CCL_ID_SUCURSAL_SS']) }} as CCL_ID_SUCURSAL_SS,
    {{ json_extract_scalar('_airbyte_data', ['CCL_NAME_ADITIONA2'], ['CCL_NAME_ADITIONA2']) }} as CCL_NAME_ADITIONA2,
    {{ json_extract_scalar('_airbyte_data', ['CCL_NAME_ADITIONA3'], ['CCL_NAME_ADITIONA3']) }} as CCL_NAME_ADITIONA3,
    {{ json_extract_scalar('_airbyte_data', ['CCL_NAME_ADITIONA4'], ['CCL_NAME_ADITIONA4']) }} as CCL_NAME_ADITIONA4,
    {{ json_extract_scalar('_airbyte_data', ['CCL_NAME_ADITIONAL'], ['CCL_NAME_ADITIONAL']) }} as CCL_NAME_ADITIONAL,
    {{ json_extract_scalar('_airbyte_data', ['IDENTIFICADOR_LOTE'], ['IDENTIFICADOR_LOTE']) }} as IDENTIFICADOR_LOTE,
    {{ json_extract_scalar('_airbyte_data', ['M4CCL_ALTURA_PERSO'], ['M4CCL_ALTURA_PERSO']) }} as M4CCL_ALTURA_PERSO,
    {{ json_extract_scalar('_airbyte_data', ['M4CCL_ID_TIPO_ALTU'], ['M4CCL_ID_TIPO_ALTU']) }} as M4CCL_ID_TIPO_ALTU,
    {{ json_extract_scalar('_airbyte_data', ['M4CCL_ID_TIPO_PESO'], ['M4CCL_ID_TIPO_PESO']) }} as M4CCL_ID_TIPO_PESO,
    {{ json_extract_scalar('_airbyte_data', ['M4CCL_PESO_PERSONA'], ['M4CCL_PESO_PERSONA']) }} as M4CCL_PESO_PERSONA,
    {{ json_extract_scalar('_airbyte_data', ['SAR_N_MARRIED_NAME'], ['SAR_N_MARRIED_NAME']) }} as SAR_N_MARRIED_NAME,
    {{ json_extract_scalar('_airbyte_data', ['SFR_NM_BIRTH_PLACE'], ['SFR_NM_BIRTH_PLACE']) }} as SFR_NM_BIRTH_PLACE,
    {{ json_extract_scalar('_airbyte_data', ['SSP_ID_PAIS_EMISOR'], ['SSP_ID_PAIS_EMISOR']) }} as SSP_ID_PAIS_EMISOR,
    {{ json_extract_scalar('_airbyte_data', ['STD_ID_SUB_GEO_DIV'], ['STD_ID_SUB_GEO_DIV']) }} as STD_ID_SUB_GEO_DIV,
    {{ json_extract_scalar('_airbyte_data', ['STD_TALLA_PANTALON'], ['STD_TALLA_PANTALON']) }} as STD_TALLA_PANTALON,
    {{ json_extract_scalar('_airbyte_data', ['SUK_OTHER_FORENAME'], ['SUK_OTHER_FORENAME']) }} as SUK_OTHER_FORENAME,
    {{ json_extract_scalar('_airbyte_data', ['SUK_PREVIOUS_SURNA'], ['SUK_PREVIOUS_SURNA']) }} as SUK_PREVIOUS_SURNA,
    {{ json_extract_scalar('_airbyte_data', ['SUS_ID_VETERAN_WHE'], ['SUS_ID_VETERAN_WHE']) }} as SUS_ID_VETERAN_WHE,
    {{ json_extract_scalar('_airbyte_data', ['STD_AHORRO_EXT_ASOC'], ['STD_AHORRO_EXT_ASOC']) }} as STD_AHORRO_EXT_ASOC,
    {{ json_extract_scalar('_airbyte_data', ['STD_AHO_ESC_EXT_ASOC'], ['STD_AHO_ESC_EXT_ASOC']) }} as STD_AHO_ESC_EXT_ASOC,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    {{ current_timestamp() }} as _airbyte_normalized_at
from {{ source('lnd_ula_pnet_prd', '_airbyte_raw_LND_TBL_STD_PERSON') }} as table_alias
-- LND_TBL_STD_PERSON
where 1 = 1
{{ incremental_clause('_airbyte_emitted_at', this) }}

